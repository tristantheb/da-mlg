function Start(){var e="1.1.2",t="tristantheb Production";$("link[disabled]").removeAttr("disabled"),console.info("Version: "+e+"\nAuthor: "+t)}function dateCheck(){if(nowDay=(new Date).getDate(),nowDay<16){var e='<div class="alert alert-danger"><h4>Information :</h4><p>Les déclarations administratives sont fermées, ce panneau n\'est ouvert que du 16 au 31 du mois.</p></div>';$("#step1").html(e),$("#step1").removeClass("card card-primary card-outline"),$("#step2").remove(),$("#step3").remove(),$("#step4").remove()}}function complete_group(){var e=$("#surname").val(),t=$("#lastname").val();$.ajax({type:"POST",url:"./includes/group_checker.php",data:{surname:e,lastname:t},dataType:"json",success:function(e){""===e.error?($("#group").val(e.group),$("select#advisor").attr("disabled",!0),$("option#val"+e.advisor).attr("selected",!0),$("#error").html("&nbsp;"),$("*").removeClass("is-invalid")):($("#group").addClass("is-invalid"),$("#error").html('<div class="alert alert-warning"><h4>Information :</h4><p>'+e.error+"</p></div>"))},error:function(e,t){0==e.status?alert("Vous êtes hors ligne !!\n Vérifiez votre connexion internet."):404==e.status?alert("L'URL demandée n'est pas trouvée."):500==e.status?alert("Erreur interne au serveur."):"parsererror"==t?alert("Erreur.\nTransmission de la requête JSON échouée."):"timeout"==t?alert("Temps de requête écoulé."):alert("Erreur inconnue.\n"+e.responseText)}})}function nextStep(e=0){if(1==e){$("*").removeClass("is-invalid");var t=[],a=0;""!=$("#month").val()&&1!=$.isNumeric($("#month").val())||(a++,t.push('- La case "Mois" n\'est pas remplie, vous devez écrire en lettres.'),$("#month").addClass("is-invalid")),(""==$("#year").val()||$("#year").val().length>2)&&(a++,t.push('- La case "Année" n\'est pas remplie, vous devez écrire les deux derniers chiffres.'),$("#year").addClass("is-invalid")),""==$("#lastname").val()&&(a++,t.push('- La case "Nom" n\'est pas remplie'),$("#lastname").addClass("is-invalid")),""==$("#surname").val()&&(a++,t.push('- La case "Prénom" n\'est pas remplie'),$("#surname").addClass("is-invalid")),(""==$("#group").val()||$("#group").val().length>7)&&(a++,t.push('- La case "Groupe" n\'est pas remplie, il faut cliquer dans la case.'),$("#group").addClass("is-invalid")),$("#advisor")[0].selectedIndex<=0&&(a++,t.push('- La case "Conseiller(ère)" n\'est pas remplie'),$("#advisor").addClass("is-invalid")),$("#activity")[0].selectedIndex<=0&&(a++,t.push('- La case "Activité" n\'est pas remplie, vous devez sélectionner ce que vous avez fait le mois passé.'),$("#activity").addClass("is-invalid")),0==$("#i_st2_work").prop("checked")&&0==$("#i_st2_seminar").prop("checked")&&0==$("#i_st2_steps").prop("checked")&&0==$("#i_st2_applications").prop("checked")&&0==$("#i_st2_education").prop("checked")&&0==$("#r_st2_other").prop("checked")&&0==$("#r_st2_nothing").prop("checked")&&0==$("#i_st2_new").prop("checked")&&(a++,t.push("- Vous n'avez coché aucune case. Vous devez donner au moins une activitée.")),""==$("#st2_work").val()&&""==$("#st2_seminar").val()&&""==$("#st2_steps").val()&&""==$("#st2_applications").val()&&""==$("#st2_education").val()&&""==$("#st2_other").val()&&""==$("#st2_nothing").val()&&0==$("#i_st2_new").prop("checked")&&(a++,t.push("- Vous ne décrivez rien dans les cases de démarches. Il faut remplir les zone de texte.")),0==a?($("#error").html("&nbsp;"),$("*").removeClass("is-invalid"),nextStep()):(t=t.join("<br>"),pageUp(),$("#error").html('<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>Tous les champs obligatoires ne sont pas complétés !<br><br>'+t+"</div>"),Swal.fire("Attention !",t,"warning"))}else $("#error").html(),document.getElementById("step"+step).style.display="none",step+=1,document.getElementById("step"+step).style.display="block",pageUp(),console.info("Step : "+step)}function prevStep(){document.getElementById("step"+step).style.display="none",step-=1,document.getElementById("step"+step).style.display="block",pageUp(),console.info("Step : "+step)}function stepShow(e){document.getElementById("opt"+e).style.display="block",null!=selected?(document.getElementById(selected).style.display="none",selected="opt"+e):selected="opt"+e}function submit(){$("*").removeClass("is-invalid");var e,t=$("#month").val(),a="20"+$("#year").val(),s=$("#lastname").val(),r=$("#surname").val(),i=$("#group").val(),n=$("#advisor").val();switch($("#activity").val()){case"1":e="J'ai travaillé de manière rémunérée auprès d'un ou plusieurs employeurs ce qui m'a permis d'acquérir de l'expérience professionnelle";break;case"2":e="J'ai réalisé différentes démarches pour ma mobilité/santé, des dépots de candidatures, ou j'ai participé à des événements/ateliers";break;case"3":e="J'ai suivi une formation certifiante/qualifiante";break;case"4":e="J'ai effectué d'autres démarches";break;case"5":e="J'entre en Garantie Jeunes"}var l=$("#st2_work").val(),o=$("#st2_seminar").val(),c=$("#st2_steps").val(),d=$("#st2_applications").val(),p=$("#st2_education").val(),u=$("#st2_other").val(),m=$("#st2_nothing").val(),v=$("#st3_pay").val(),h=$("#st3_salaire").prop("checked"),_=$("#st3_rsa").prop("checked"),f=$("#st3_ape").prop("checked"),g=$("#st3_pri_a").prop("checked"),y=$("#st3_aah").prop("checked"),b=$("#st3_pen_a").prop("checked"),k=$("#st3_rs").prop("checked"),w=$("#st3_other").prop("checked"),x=$("#type_key").val(),C=$("#certify").prop("checked");""!=v?$.isNumeric(v)?1==C?($("#error").html("&nbsp;"),console.info("Start ajax POST"),$.ajax({type:"POST",url:"./includes/form_submit.php",data:{month:t,year:a,lastname:s,surname:r,group:i,advisor:n,activity:e,st2_work:l,st2_seminar:o,st2_steps:c,st2_applications:d,st2_education:p,st2_other:u,st2_nothing:m,st3_pay:v,st3_salaire:h,st3_rsa:_,st3_ape:f,st3_pri_a:g,st3_aah:y,st3_pen_a:b,st3_rs:k,st3_other:w,type_key:x,certify:C},dataType:"json",success:function(e){1==e.msg&&0==e.warn?(table='<div class="alert alert-success">Votre déclaration est bien enregistrée. Retounrez sur <a href="activity_check.php">l\'administration</a> pour pouvoir l\'impirmer.</div>',$("#step4").html(table),console.info("Page generated"),nextStep(),console.info("Page loaded")):1==e.warn?(pageUp(),$("#error").html('<div class="alert alert-danger alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>'+e.msg+"</div>"),Swal.fire({title:"Alerte",text:e.msg,icon:"error",timer:6e4,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1})):(pageUp(),$("#error").html('<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>'+e.msg+"</div>"),Swal.fire("Attention",e.msg,"warning"))},error:function(e,t){0==e.status?alert("Vous êtes hors ligne !!\n Vérifiez votre connexion internet."):404==e.status?alert("L'URL demandée n'est pas trouvée."):500==e.status?alert("Erreur interne au serveur."):"parsererror"==t?alert("Erreur.\nTransmission de la requête JSON échouée."):"timeout"==t?alert("Temps de requête écoulé."):alert("Erreur inconnue.\n"+e.responseText)}})):(pageUp(),$("#certify").addClass("is-invalid"),$("#error").html('<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>Votre déclaration d\'activité n\'est pas certifiée. Si vous ne cochez pas cette case, votre document ne sera pas validé.</div>')):(pageUp(),$("#st3_pay").addClass("is-invalid"),$("#error").html('<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>Vous ne pouvez pas indiquer un montant en lettres.</div>')):(pageUp(),$("#st3_pay").addClass("is-invalid"),$("#error").html('<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button><h5><i class="icon fas fa-exclamation-triangle"></i> Alerte !</h5>Vous n\'avez indiqué aucun montant !</div>'))}function pageUp(){$(window).scrollTop(-1e3),console.info("ScrollTop")}var selected,step=0;$(document).ready(function(){Start(),step+=1,console.info("Step : "+step),document.getElementById("step"+step).style.display="block",dateCheck()});